#include <bits/stdc++.h>
using namespace std;
#define ll long long

int main() {
    int t, n, a;
    cin >> t;

    while (t--) {       // greedy approach
        cin >> n;
        int ans = 0, count = 0;     
        // count stores no of rem prime factors after pairing them up

        map <int, int> mp;      // {prime factor : count}
        for (int i = 0; i < n; i ++) {
            cin >> a;

            for (int j = 2; j * j <= a; j ++) {
                while (a % j == 0) {
                    mp[j] ++;
                    a = a / j;
                }       // we iterate till sqrt(a) only, efficient
            }
            if (a != 1)     // executes if a is prime
                mp[a] ++;   // as a itself is a prime factor
        }      
        for (auto it : mp) {
            ans += it.second / 2;   // 2 same prime factors can be grouped
            count += it.second % 2;     // rem count of that factor
        }        
        ans += count / 3;   // 3 separate prime no can be grouped
        cout << ans << "\n";
    }
    return 0;
}